import{u as dl,o as vl,a as fl,b as ml,p as gl,q as pl,r as hl,d as yl,e as Sl,f as bl,t as wl,v as kl,w as $t,x as Mt,Q as Cl,l as _l,n as xl,k as Vl,m as ql}from"./use-prevent-scroll-CC1hw97h.js";import{c as Be,r as _,a as p,g as et,w as oe,aa as Il,d as dt,h as T,ab as At,b as Dt,J as _e,M as O,N as Z,R as M,W as K,K as ue,S as J,o as Lt,H as vt,U as C,ac as $l,X as ae,a2 as xe,n as Ml,e as fe,ad as Al,ae as zl,a6 as Tl,a7 as Pl,af as De,ag as El,y as ut,B as ze,ah as Bl,ai as Fl,Y as he,z as Te,aj as Rl,p as jt,ak as Ol,al as Dl,am as Ll,an as jl,T as Hl,$ as Xe,a0 as Ye,a1 as Nl,V as Ul,L as Pe,ao as Ql}from"./index-CXq9CTF8.js";import{h as Kl,u as Ht,i as ft,g as Nt,c as Ut,a as Wl,d as Gl,f as zt,j as Xl,Q as ct}from"./QInput-CswTMnKx.js";import{Q as Yl}from"./QPage-CkjkMqrf.js";import{a as Qt,u as Zl,f as Jl}from"./auth-hsunw1s2.js";import{Q as mt}from"./QCard-Co4yfh_r.js";import{Q as Ze,a as ea}from"./QBanner-B_s6jZof.js";import{Q as ta}from"./QChip-DfoT4nIb.js";import{n as Tt}from"./format-CJebrXOQ.js";import{u as la,a as aa}from"./use-dark-BOkxeG5n.js";const Pt=[{name:"Smileys",emojis:["ðŸ˜‚","ðŸ˜","ðŸ¤£","ðŸ˜Š","ðŸ˜­","ðŸ˜Ž","ðŸ˜‰","ðŸ˜…","ðŸ¤”","ðŸ˜œ","ðŸ˜‡","ðŸ˜¡","ðŸ˜±","ðŸ¤¯","ðŸ¥³"]},{name:"Animals",emojis:["ðŸ¶","ðŸ±","ðŸ¦","ðŸ¯","ðŸ¸","ðŸµ","ðŸ¦„","ðŸ","ðŸž","ðŸ¦‹"]},{name:"Food",emojis:["ðŸŽ","ðŸ”","ðŸ•","ðŸŸ","ðŸ£","ðŸª","ðŸ©","ðŸ«","ðŸ¿","ðŸ¦"]},{name:"Activities",emojis:["âš½","ðŸ€","ðŸˆ","ðŸŽ¾","ðŸ“","ðŸ¸","ðŸ¥Š","ðŸŽ®","ðŸŽ²","ðŸŽ¯"]},{name:"Symbols",emojis:["â¤ï¸","ðŸ’”","ðŸ”¥","â­","ðŸŒˆ","âš¡","â˜€ï¸","ðŸŒ™","ðŸ’¡","ðŸŽµ"]}];let Ge=0;const oa={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Et={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},tt=Be({name:"QDialog",inheritAttrs:!1,props:{...fl,...vl,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...dl,"shake","click","escapeKey"],setup(e,{slots:i,emit:o,attrs:s}){const v=et(),l=_(null),r=_(!1),c=_(!1);let d=null,w=null,n,y;const h=p(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:x}=bl(),{registerTimeout:$}=ml(),{registerTick:D,removeTick:B}=gl(),{transitionProps:X,transitionStyle:Y}=pl(e,()=>Et[e.position][0],()=>Et[e.position][1]),A=p(()=>Y.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:b,hidePortal:I,portalIsAccessible:F,renderPortal:Q}=hl(v,l,W,"dialog"),{hide:L}=yl({showing:r,hideOnRouteChange:h,handleShow:ie,handleHide:se,processOnMount:!0}),{addToHistory:ne,removeFromHistory:le}=Sl(r,L,h),k=p(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${oa[e.position]}`+(c.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),V=p(()=>r.value===!0&&e.seamless!==!0),u=p(()=>e.autoClose===!0?{onClick:f}:{}),R=p(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${V.value===!0?"modal":"seamless"}`,s.class]);oe(()=>e.maximized,S=>{r.value===!0&&a(S)}),oe(V,S=>{x(S),S===!0?(wl(j),kl(de)):($t(j),Mt(de))});function ie(S){ne(),w=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,a(e.maximized),b(),c.value=!0,e.noFocus!==!0?(document.activeElement?.blur(),D(me)):B(),$(()=>{if(v.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:q,bottom:N}=document.activeElement.getBoundingClientRect(),{innerHeight:z}=window,ee=window.visualViewport!==void 0?window.visualViewport.height:z;q>0&&N>ee/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ee,N>=z?1/0:Math.ceil(document.scrollingElement.scrollTop+N-ee/2))),document.activeElement.scrollIntoView()}y=!0,l.value.click(),y=!1}b(!0),c.value=!1,o("show",S)},e.transitionDuration)}function se(S){B(),le(),ye(!0),c.value=!0,I(),w!==null&&(((S?.type.indexOf("key")===0?w.closest('[tabindex]:not([tabindex^="-"])'):void 0)||w).focus(),w=null),$(()=>{I(!0),c.value=!1,o("hide",S)},e.transitionDuration)}function me(S){Kl(()=>{let q=l.value;if(q!==null){if(S!==void 0){const N=q.querySelector(S);if(N!==null){N.focus({preventScroll:!0});return}}q.contains(document.activeElement)!==!0&&(q=q.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||q.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||q.querySelector("[autofocus], [data-autofocus]")||q,q.focus({preventScroll:!0}))}})}function ge(S){S&&typeof S.focus=="function"?S.focus({preventScroll:!0}):me(),o("shake");const q=l.value;q!==null&&(q.classList.remove("q-animate--scale"),q.classList.add("q-animate--scale"),d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,l.value!==null&&(q.classList.remove("q-animate--scale"),me())},170))}function de(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&ge():(o("escapeKey"),L()))}function ye(S){d!==null&&(clearTimeout(d),d=null),(S===!0||r.value===!0)&&(a(!1),e.seamless!==!0&&(x(!1),$t(j),Mt(de))),S!==!0&&(w=null)}function a(S){S===!0?n!==!0&&(Ge<1&&document.body.classList.add("q-body--dialog"),Ge++,n=!0):n===!0&&(Ge<2&&document.body.classList.remove("q-body--dialog"),Ge--,n=!1)}function f(S){y!==!0&&(L(S),o("click",S))}function P(S){e.persistent!==!0&&e.noBackdropDismiss!==!0?L(S):e.noShake!==!0&&ge()}function j(S){e.allowFocusOutside!==!0&&F.value===!0&&Il(l.value,S.target)!==!0&&me('[tabindex]:not([tabindex="-1"])')}Object.assign(v.proxy,{focus:me,shake:ge,__updateRefocusTarget(S){w=S||null}}),dt(ye);function W(){return T("div",{role:"dialog","aria-modal":V.value===!0?"true":"false",...s,class:R.value},[T(At,{name:"q-transition--fade",appear:!0},()=>V.value===!0?T("div",{class:"q-dialog__backdrop fixed-full",style:A.value,"aria-hidden":"true",tabindex:-1,onClick:P}):null),T(At,X.value,()=>r.value===!0?T("div",{ref:l,class:k.value,style:Y.value,tabindex:-1,...u.value},Dt(i.default)):null)])}return Q}}),je=(e,i)=>{const o=e.__vccOpts||e;for(const[s,v]of i)o[s]=v;return o},na={key:0,class:"media-display"},ia=["src"],ua=["src"],ra={__name:"MediaGallery",props:{modelValue:{type:Boolean,required:!0},mediaIndex:{type:Number,default:0},media:{type:Array,default:null}},emits:["update:modelValue"],setup(e,{emit:i}){const o=e,s=i,v=p({get:()=>o.modelValue,set:w=>s("update:modelValue",w)}),l=_(o.mediaIndex);oe(()=>o.mediaIndex,w=>{o.mediaIndex,l.value=w});function r(){l.value=(l.value-1+o.media.length)%o.media.length}function c(){l.value=(l.value+1)%o.media.length}function d(){s("update:modelValue",!1)}return(w,n)=>(O(),_e(tt,{modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=y=>v.value=y),maximized:""},{default:Z(()=>[M(mt,{class:"bg-black flex flex-center"},{default:Z(()=>[M(J,{icon:"close",flat:"",round:"",color:"white",class:"absolute-top-right q-ma-md",onClick:d}),M(J,{icon:"chevron_left",flat:"",round:"",color:"white",class:"nav-arrow nav-left",onClick:r}),e.media&&e.media[l.value]?(O(),K("div",na,[e.media[l.value].type==="image"?(O(),K("img",{key:0,src:e.media[l.value].url,style:{"max-width":"100%","max-height":"100%","object-fit":"contain"}},null,8,ia)):e.media[l.value].type==="video"?(O(),K("video",{key:1,src:e.media[l.value].url,controls:"",style:{"max-width":"100%","max-height":"100%","object-fit":"contain"},onClick:n[0]||(n[0]=(...y)=>w.handleVideoClick&&w.handleVideoClick(...y)),ref:"videoPlayer"}," Your browser does not support the video tag. ",8,ua)):ue("",!0)])):ue("",!0),M(J,{icon:"chevron_right",flat:"",round:"",color:"white",class:"nav-arrow nav-right",onClick:c})]),_:1})]),_:1},8,["modelValue"]))}},sa=je(ra,[["__scopeId","data-v-4e0808b7"]]),ca={class:"audio-player"},da={class:"audio-content"},va={class:"audio-progress-bar"},fa={class:"audio-time"},ma={__name:"AudioPlayer",props:{audioUrl:{type:String,required:!0},isMe:{type:Boolean,default:!1},messageId:{type:Number,default:0},duration:{type:Number,default:0}},setup(e){const i=e,o=_(null),s=_(!1),v=_(0),l=_(i.duration||0),r=_(0),c=p(()=>s.value),d=h=>{if(!h||isNaN(h))return"0:00";const x=Math.floor(h/60),$=Math.floor(h%60);return`${x}:${$<10?"0":""}${$}`},w=()=>{o.value||(o.value=new Audio(i.audioUrl),o.value.addEventListener("loadedmetadata",()=>{i.duration<=0&&(l.value=o.value.duration||0)}),o.value.addEventListener("timeupdate",()=>{v.value=o.value.currentTime,l.value>0&&(r.value=v.value/l.value*100)}),o.value.addEventListener("ended",()=>{s.value=!1,v.value=0,r.value=0,o.value&&(o.value.currentTime=0)}),o.value.addEventListener("error",h=>{console.error("Audio error:",h),s.value=!1}))},n=async()=>{try{o.value||w(),s.value?(o.value.pause(),s.value=!1):(await o.value.play(),s.value=!0)}catch(h){console.error("Playback error:",h),s.value=!1}},y=h=>{if(!o.value||l.value<=0)return;const x=h.currentTarget.querySelector(".audio-progress-bar");if(!x)return;const $=x.getBoundingClientRect(),B=(h.clientX-$.left)/$.width*l.value;o.value.currentTime=Math.min(B,l.value),v.value=o.value.currentTime};return oe(()=>i.duration,h=>{h>0&&(l.value=h)}),Lt(()=>{i.duration>0&&(l.value=i.duration)}),vt(()=>{o.value&&(o.value.pause(),o.value.src="",o.value=null)}),(h,x)=>(O(),K("div",{class:xe(["audio-message-container",{"audio-me":e.isMe}])},[C("div",ca,[M(J,{round:"",dense:"",flat:"",icon:c.value?"pause":"play_arrow",color:e.isMe?"black":"primary",size:"sm",onClick:n,class:"audio-play-btn"},null,8,["icon","color"]),C("div",da,[C("div",{class:"audio-progress-container",onClick:y},[C("div",va,[C("div",{class:"audio-progress-fill",style:$l({width:r.value+"%"})},null,4)])]),C("div",fa,ae(d(v.value))+" / "+ae(d(l.value)),1)])])],2))}},ga=je(ma,[["__scopeId","data-v-47024727"]]),pa=Be({name:"QSpace",setup(){const e=T("div",{class:"q-space"});return()=>e}}),ha=Be({name:"QField",inheritAttrs:!1,props:{...ft,tag:{type:String,default:"label"}},emits:Ht,setup(){return Nt(Ut({tagProp:!0}))}});let Je=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const i=document.createElement("div");Object.assign(i.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(i),e.scrollLeft=-1e3,Je=e.scrollLeft>=0,e.remove()}const ce=1e3,ya=["start","center","end","start-force","center-force","end-force"],Kt=Array.prototype.filter,Sa=window.getComputedStyle(document.body).overflowAnchor===void 0?Ml:function(e,i){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const o=e.children||[];Kt.call(o,v=>v.dataset&&v.dataset.qVsAnchor!==void 0).forEach(v=>{delete v.dataset.qVsAnchor});const s=o[i];s?.dataset&&(s.dataset.qVsAnchor="")}))};function Ee(e,i){return e+i}function rt(e,i,o,s,v,l,r,c){const d=e===window?document.scrollingElement||document.documentElement:e,w=v===!0?"offsetWidth":"offsetHeight",n={scrollStart:0,scrollViewSize:-r-c,scrollMaxSize:0,offsetStart:-r,offsetEnd:-c};if(v===!0?(e===window?(n.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,n.scrollViewSize+=document.documentElement.clientWidth):(n.scrollStart=d.scrollLeft,n.scrollViewSize+=d.clientWidth),n.scrollMaxSize=d.scrollWidth,l===!0&&(n.scrollStart=(Je===!0?n.scrollMaxSize-n.scrollViewSize:0)-n.scrollStart)):(e===window?(n.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,n.scrollViewSize+=document.documentElement.clientHeight):(n.scrollStart=d.scrollTop,n.scrollViewSize+=d.clientHeight),n.scrollMaxSize=d.scrollHeight),o!==null)for(let y=o.previousElementSibling;y!==null;y=y.previousElementSibling)y.classList.contains("q-virtual-scroll--skip")===!1&&(n.offsetStart+=y[w]);if(s!==null)for(let y=s.nextElementSibling;y!==null;y=y.nextElementSibling)y.classList.contains("q-virtual-scroll--skip")===!1&&(n.offsetEnd+=y[w]);if(i!==e){const y=d.getBoundingClientRect(),h=i.getBoundingClientRect();v===!0?(n.offsetStart+=h.left-y.left,n.offsetEnd-=h.width):(n.offsetStart+=h.top-y.top,n.offsetEnd-=h.height),e!==window&&(n.offsetStart+=n.scrollStart),n.offsetEnd+=n.scrollMaxSize-n.offsetStart}return n}function Bt(e,i,o,s){i==="end"&&(i=(e===window?document.body:e)[o===!0?"scrollWidth":"scrollHeight"]),e===window?o===!0?(s===!0&&(i=(Je===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-i),window.scrollTo(i,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,i):o===!0?(s===!0&&(i=(Je===!0?e.scrollWidth-e.offsetWidth:0)-i),e.scrollLeft=i):e.scrollTop=i}function Le(e,i,o,s){if(o>=s)return 0;const v=i.length,l=Math.floor(o/ce),r=Math.floor((s-1)/ce)+1;let c=e.slice(l,r).reduce(Ee,0);return o%ce!==0&&(c-=i.slice(l*ce,o).reduce(Ee,0)),s%ce!==0&&s!==v&&(c-=i.slice(s,r*ce).reduce(Ee,0)),c}const ba={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Ft={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...ba};function wa({virtualScrollLength:e,getVirtualScrollTarget:i,getVirtualScrollEl:o,virtualScrollItemSizeComputed:s}){const v=et(),{props:l,emit:r,proxy:c}=v,{$q:d}=c;let w,n,y,h=[],x;const $=_(0),D=_(0),B=_({}),X=_(null),Y=_(null),A=_(null),b=_({from:0,to:0}),I=p(()=>l.tableColspan!==void 0?l.tableColspan:100);s===void 0&&(s=p(()=>l.virtualScrollItemSize));const F=p(()=>s.value+";"+l.virtualScrollHorizontal),Q=p(()=>F.value+";"+l.virtualScrollSliceRatioBefore+";"+l.virtualScrollSliceRatioAfter);oe(Q,()=>{se()}),oe(F,L);function L(){ie(n,!0)}function ne(a){ie(a===void 0?n:a)}function le(a,f){const P=i();if(P==null||P.nodeType===8)return;const j=rt(P,o(),X.value,Y.value,l.virtualScrollHorizontal,d.lang.rtl,l.virtualScrollStickySizeStart,l.virtualScrollStickySizeEnd);y!==j.scrollViewSize&&se(j.scrollViewSize),V(P,j,Math.min(e.value-1,Math.max(0,parseInt(a,10)||0)),0,ya.indexOf(f)!==-1?f:n!==-1&&a>n?"end":"start")}function k(){const a=i();if(a==null||a.nodeType===8)return;const f=rt(a,o(),X.value,Y.value,l.virtualScrollHorizontal,d.lang.rtl,l.virtualScrollStickySizeStart,l.virtualScrollStickySizeEnd),P=e.value-1,j=f.scrollMaxSize-f.offsetStart-f.offsetEnd-D.value;if(w===f.scrollStart)return;if(f.scrollMaxSize<=0){V(a,f,0,0);return}y!==f.scrollViewSize&&se(f.scrollViewSize),u(b.value.from);const W=Math.floor(f.scrollMaxSize-Math.max(f.scrollViewSize,f.offsetEnd)-Math.min(x[P],f.scrollViewSize/2));if(W>0&&Math.ceil(f.scrollStart)>=W){V(a,f,P,f.scrollMaxSize-f.offsetEnd-h.reduce(Ee,0));return}let S=0,q=f.scrollStart-f.offsetStart,N=q;if(q<=j&&q+f.scrollViewSize>=$.value)q-=$.value,S=b.value.from,N=q;else for(let z=0;q>=h[z]&&S<P;z++)q-=h[z],S+=ce;for(;q>0&&S<P;)q-=x[S],q>-f.scrollViewSize?(S++,N=q):N=x[S]+q;V(a,f,S,N)}function V(a,f,P,j,W){const S=typeof W=="string"&&W.indexOf("-force")!==-1,q=S===!0?W.replace("-force",""):W,N=q!==void 0?q:"start";let z=Math.max(0,P-B.value[N]),ee=z+B.value.total;ee>e.value&&(ee=e.value,z=Math.max(0,ee-B.value.total)),w=f.scrollStart;const Se=z!==b.value.from||ee!==b.value.to;if(Se===!1&&q===void 0){ge(P);return}const{activeElement:He}=document,pe=A.value;Se===!0&&pe!==null&&pe!==He&&pe.contains(He)===!0&&(pe.addEventListener("focusout",R),setTimeout(()=>{pe?.removeEventListener("focusout",R)})),Sa(pe,P-z);const Ne=q!==void 0?x.slice(z,P).reduce(Ee,0):0;if(Se===!0){const be=ee>=b.value.from&&z<=b.value.to?b.value.to:ee;b.value={from:z,to:be},$.value=Le(h,x,0,z),D.value=Le(h,x,ee,e.value),requestAnimationFrame(()=>{b.value.to!==ee&&w===f.scrollStart&&(b.value={from:b.value.from,to:ee},D.value=Le(h,x,ee,e.value))})}requestAnimationFrame(()=>{if(w!==f.scrollStart)return;Se===!0&&u(z);const be=x.slice(z,P).reduce(Ee,0),we=be+f.offsetStart+$.value,Ue=we+x[P];let Fe=we+j;if(q!==void 0){const lt=be-Ne,Re=f.scrollStart+lt;Fe=S!==!0&&Re<we&&Ue<Re+f.scrollViewSize?Re:q==="end"?Ue-f.scrollViewSize:we-(q==="start"?0:Math.round((f.scrollViewSize-x[P])/2))}w=Fe,Bt(a,Fe,l.virtualScrollHorizontal,d.lang.rtl),ge(P)})}function u(a){const f=A.value;if(f){const P=Kt.call(f.children,z=>z.classList&&z.classList.contains("q-virtual-scroll--skip")===!1),j=P.length,W=l.virtualScrollHorizontal===!0?z=>z.getBoundingClientRect().width:z=>z.offsetHeight;let S=a,q,N;for(let z=0;z<j;){for(q=W(P[z]),z++;z<j&&P[z].classList.contains("q-virtual-scroll--with-prev")===!0;)q+=W(P[z]),z++;N=q-x[S],N!==0&&(x[S]+=N,h[Math.floor(S/ce)]+=N),S++}}}function R(){A.value?.focus()}function ie(a,f){const P=1*s.value;(f===!0||Array.isArray(x)===!1)&&(x=[]);const j=x.length;x.length=e.value;for(let S=e.value-1;S>=j;S--)x[S]=P;const W=Math.floor((e.value-1)/ce);h=[];for(let S=0;S<=W;S++){let q=0;const N=Math.min((S+1)*ce,e.value);for(let z=S*ce;z<N;z++)q+=x[z];h.push(q)}n=-1,w=void 0,$.value=Le(h,x,0,b.value.from),D.value=Le(h,x,b.value.to,e.value),a>=0?(u(b.value.from),fe(()=>{le(a)})):de()}function se(a){if(a===void 0&&typeof window<"u"){const q=i();q!=null&&q.nodeType!==8&&(a=rt(q,o(),X.value,Y.value,l.virtualScrollHorizontal,d.lang.rtl,l.virtualScrollStickySizeStart,l.virtualScrollStickySizeEnd).scrollViewSize)}y=a;const f=parseFloat(l.virtualScrollSliceRatioBefore)||0,P=parseFloat(l.virtualScrollSliceRatioAfter)||0,j=1+f+P,W=a===void 0||a<=0?1:Math.ceil(a/s.value),S=Math.max(1,W,Math.ceil((l.virtualScrollSliceSize>0?l.virtualScrollSliceSize:10)/j));B.value={total:Math.ceil(S*j),start:Math.ceil(S*f),center:Math.ceil(S*(.5+f)),end:Math.ceil(S*(1+f)),view:W}}function me(a,f){const P=l.virtualScrollHorizontal===!0?"width":"height",j={["--q-virtual-scroll-item-"+P]:s.value+"px"};return[a==="tbody"?T(a,{class:"q-virtual-scroll__padding",key:"before",ref:X},[T("tr",[T("td",{style:{[P]:`${$.value}px`,...j},colspan:I.value})])]):T(a,{class:"q-virtual-scroll__padding",key:"before",ref:X,style:{[P]:`${$.value}px`,...j}}),T(a,{class:"q-virtual-scroll__content",key:"content",ref:A,tabindex:-1},f.flat()),a==="tbody"?T(a,{class:"q-virtual-scroll__padding",key:"after",ref:Y},[T("tr",[T("td",{style:{[P]:`${D.value}px`,...j},colspan:I.value})])]):T(a,{class:"q-virtual-scroll__padding",key:"after",ref:Y,style:{[P]:`${D.value}px`,...j}})]}function ge(a){n!==a&&(l.onVirtualScroll!==void 0&&r("virtualScroll",{index:a,from:b.value.from,to:b.value.to-1,direction:a<n?"decrease":"increase",ref:c}),n=a)}se();const de=Al(k,d.platform.is.ios===!0?120:35);zl(()=>{se()});let ye=!1;return Tl(()=>{ye=!0}),Pl(()=>{if(ye!==!0)return;const a=i();w!==void 0&&a!==void 0&&a!==null&&a.nodeType!==8?Bt(a,w,l.virtualScrollHorizontal,d.lang.rtl):le(n)}),dt(()=>{de.cancel()}),Object.assign(c,{scrollTo:le,reset:L,refresh:ne}),{virtualScrollSliceRange:b,virtualScrollSliceSizeComputed:B,setVirtualScrollSize:se,onVirtualScrollEvt:de,localResetVirtualScroll:ie,padVirtualScroll:me,scrollTo:le,reset:L,refresh:ne}}const Rt=e=>["add","add-unique","toggle"].includes(e),ka=".*+?^${}()|[]\\",Ca=Object.keys(ft);function st(e,i){if(typeof e=="function")return e;const o=e!==void 0?e:i;return s=>s!==null&&typeof s=="object"&&o in s?s[o]:s}const _a=Be({name:"QSelect",inheritAttrs:!1,props:{...Ft,...Wl,...ft,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:Rt},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:Ft.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...Ht,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:i,emit:o}){const{proxy:s}=et(),{$q:v}=s,l=_(!1),r=_(!1),c=_(-1),d=_(""),w=_(!1),n=_(!1);let y=null,h=null,x,$,D,B=null,X,Y,A,b;const I=_(null),F=_(null),Q=_(null),L=_(null),ne=_(null),le=Gl(e),k=Xl(_t),V=p(()=>Array.isArray(e.options)?e.options.length:0),u=p(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:R,virtualScrollSliceSizeComputed:ie,localResetVirtualScroll:se,padVirtualScroll:me,onVirtualScrollEvt:ge,scrollTo:de,setVirtualScrollSize:ye}=wa({virtualScrollLength:V,getVirtualScrollTarget:Zt,getVirtualScrollEl:kt,virtualScrollItemSizeComputed:u}),a=Ut(),f=p(()=>{const t=e.mapOptions===!0&&e.multiple!==!0,m=e.modelValue!==void 0&&(e.modelValue!==null||t===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const g=e.mapOptions===!0&&x!==void 0?x:[],E=m.map(U=>Yt(U,g));return e.modelValue===null&&t===!0?E.filter(U=>U!==null):E}return m}),P=p(()=>{const t={};return Ca.forEach(m=>{const g=e[m];g!==void 0&&(t[m]=g)}),t}),j=p(()=>e.optionsDark===null?a.isDark.value:e.optionsDark),W=p(()=>zt(f.value)),S=p(()=>{let t="q-field__input q-placeholder col";return e.hideSelected===!0||f.value.length===0?[t,e.inputClass]:(t+=" q-field__input--padding",e.inputClass===void 0?t:[t,e.inputClass])}),q=p(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),N=p(()=>V.value===0),z=p(()=>f.value.map(t=>re.value(t)).join(", ")),ee=p(()=>e.displayValue!==void 0?e.displayValue:z.value),Se=p(()=>e.optionsHtml===!0?()=>!0:t=>t?.html===!0),He=p(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||f.value.some(Se.value))),pe=p(()=>a.focused.value===!0?e.tabindex:-1),Ne=p(()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":l.value===!0?"true":"false","aria-controls":`${a.targetUid.value}_lb`};return c.value>=0&&(t["aria-activedescendant"]=`${a.targetUid.value}_${c.value}`),t}),be=p(()=>({id:`${a.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),we=p(()=>f.value.map((t,m)=>({index:m,opt:t,html:Se.value(t),selected:!0,removeAtIndex:Xt,toggleOption:ke,tabindex:pe.value}))),Ue=p(()=>{if(V.value===0)return[];const{from:t,to:m}=R.value;return e.options.slice(t,m).map((g,E)=>{const U=Ve.value(g)===!0,H=ot(g)===!0,te=t+E,G={clickable:!0,active:H,activeClass:Re.value,manualFocus:!0,focused:!1,disable:U,tabindex:-1,dense:e.optionsDense,dark:j.value,role:"option","aria-selected":H===!0?"true":"false",id:`${a.targetUid.value}_${te}`,onClick:()=>{ke(g)}};return U!==!0&&(c.value===te&&(G.focused=!0),v.platform.is.desktop===!0&&(G.onMousemove=()=>{l.value===!0&&qe(te)})),{index:te,opt:g,html:Se.value(g),label:re.value(g),selected:G.active,focused:G.focused,toggleOption:ke,setOptionIndex:qe,itemProps:G}})}),Fe=p(()=>e.dropdownIcon!==void 0?e.dropdownIcon:v.iconSet.arrow.dropdown),lt=p(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Re=p(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),ve=p(()=>st(e.optionValue,"value")),re=p(()=>st(e.optionLabel,"label")),Ve=p(()=>st(e.optionDisable,"disable")),Qe=p(()=>f.value.map(ve.value)),Gt=p(()=>{const t={onInput:_t,onChange:k,onKeydown:wt,onKeyup:St,onKeypress:bt,onFocus:ht,onClick(m){$===!0&&Te(m)}};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=k,t});oe(f,t=>{x=t,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&a.innerLoading.value!==!0&&(r.value!==!0&&l.value!==!0||W.value!==!0)&&(D!==!0&&Ae(),(r.value===!0||l.value===!0)&&Ie(""))},{immediate:!0}),oe(()=>e.fillInput,Ae),oe(l,nt),oe(V,cl);function gt(t){return e.emitValue===!0?ve.value(t):t}function at(t){if(t!==-1&&t<f.value.length)if(e.multiple===!0){const m=e.modelValue.slice();o("remove",{index:t,value:m.splice(t,1)[0]}),o("update:modelValue",m)}else o("update:modelValue",null)}function Xt(t){at(t),a.focus()}function pt(t,m){const g=gt(t);if(e.multiple!==!0){e.fillInput===!0&&Oe(re.value(t),!0,!0),o("update:modelValue",g);return}if(f.value.length===0){o("add",{index:0,value:g}),o("update:modelValue",e.multiple===!0?[g]:g);return}if(m===!0&&ot(t)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const E=e.modelValue.slice();o("add",{index:E.length,value:g}),E.push(g),o("update:modelValue",E)}function ke(t,m){if(a.editable.value!==!0||t===void 0||Ve.value(t)===!0)return;const g=ve.value(t);if(e.multiple!==!0){m!==!0&&(Oe(e.fillInput===!0?re.value(t):"",!0,!0),Ce()),F.value?.focus(),(f.value.length===0||De(ve.value(f.value[0]),g)!==!0)&&o("update:modelValue",e.emitValue===!0?g:t);return}if(($!==!0||w.value===!0)&&a.focus(),ht(),f.value.length===0){const H=e.emitValue===!0?g:t;o("add",{index:0,value:H}),o("update:modelValue",e.multiple===!0?[H]:H);return}const E=e.modelValue.slice(),U=Qe.value.findIndex(H=>De(H,g));if(U!==-1)o("remove",{index:U,value:E.splice(U,1)[0]});else{if(e.maxValues!==void 0&&E.length>=e.maxValues)return;const H=e.emitValue===!0?g:t;o("add",{index:E.length,value:H}),E.push(H)}o("update:modelValue",E)}function qe(t){if(v.platform.is.desktop!==!0)return;const m=t!==-1&&t<V.value?t:-1;c.value!==m&&(c.value=m)}function Ke(t=1,m){if(l.value===!0){let g=c.value;do g=Tt(g+t,-1,V.value-1);while(g!==-1&&g!==c.value&&Ve.value(e.options[g])===!0);c.value!==g&&(qe(g),de(g),m!==!0&&e.useInput===!0&&e.fillInput===!0&&We(g>=0?re.value(e.options[g]):X,!0))}}function Yt(t,m){const g=E=>De(ve.value(E),t);return e.options.find(g)||m.find(g)||t}function ot(t){const m=ve.value(t);return Qe.value.find(g=>De(g,m))!==void 0}function ht(t){e.useInput===!0&&F.value!==null&&(t===void 0||F.value===t.target&&t.target.value===z.value)&&F.value.select()}function yt(t){Rl(t,27)===!0&&l.value===!0&&(Te(t),Ce(),Ae()),o("keyup",t)}function St(t){const{value:m}=t.target;if(t.keyCode!==void 0){yt(t);return}if(t.target.value="",y!==null&&(clearTimeout(y),y=null),h!==null&&(clearTimeout(h),h=null),Ae(),typeof m=="string"&&m.length!==0){const g=m.toLocaleLowerCase(),E=H=>{const te=e.options.find(G=>String(H.value(G)).toLocaleLowerCase()===g);return te===void 0?!1:(f.value.indexOf(te)===-1?ke(te):Ce(),!0)},U=H=>{E(ve)!==!0&&H!==!0&&E(re)!==!0&&Ie(m,!0,()=>U(!0))};U()}else a.clearValue(t)}function bt(t){o("keypress",t)}function wt(t){if(o("keydown",t),El(t)===!0)return;const m=d.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),g=t.shiftKey!==!0&&e.disableTabSelection!==!0&&e.multiple!==!0&&(c.value!==-1||m===!0);if(t.keyCode===27){ut(t);return}if(t.keyCode===9&&g===!1){$e();return}if(t.target===void 0||t.target.id!==a.targetUid.value||a.editable.value!==!0)return;if(t.keyCode===40&&a.innerLoading.value!==!0&&l.value===!1){ze(t),Me();return}if(t.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&d.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?at(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&o("update:modelValue",null);return}(t.keyCode===35||t.keyCode===36)&&(typeof d.value!="string"||d.value.length===0)&&(ze(t),c.value=-1,Ke(t.keyCode===36?1:-1,e.multiple)),(t.keyCode===33||t.keyCode===34)&&ie.value!==void 0&&(ze(t),c.value=Math.max(-1,Math.min(V.value,c.value+(t.keyCode===33?-1:1)*ie.value.view)),Ke(t.keyCode===33?1:-1,e.multiple)),(t.keyCode===38||t.keyCode===40)&&(ze(t),Ke(t.keyCode===38?-1:1,e.multiple));const E=V.value;if((A===void 0||b<Date.now())&&(A=""),E>0&&e.useInput!==!0&&t.key!==void 0&&t.key.length===1&&t.altKey===!1&&t.ctrlKey===!1&&t.metaKey===!1&&(t.keyCode!==32||A.length!==0)){l.value!==!0&&Me(t);const U=t.key.toLocaleLowerCase(),H=A.length===1&&A[0]===U;b=Date.now()+1500,H===!1&&(ze(t),A+=U);const te=new RegExp("^"+A.split("").map(it=>ka.indexOf(it)!==-1?"\\"+it:it).join(".*"),"i");let G=c.value;if(H===!0||G<0||te.test(re.value(e.options[G]))!==!0)do G=Tt(G+1,-1,E-1);while(G!==c.value&&(Ve.value(e.options[G])===!0||te.test(re.value(e.options[G]))!==!0));c.value!==G&&fe(()=>{qe(G),de(G),G>=0&&e.useInput===!0&&e.fillInput===!0&&We(re.value(e.options[G]),!0)});return}if(!(t.keyCode!==13&&(t.keyCode!==32||e.useInput===!0||A!=="")&&(t.keyCode!==9||g===!1))){if(t.keyCode!==9&&ze(t),c.value!==-1&&c.value<E){ke(e.options[c.value]);return}if(m===!0){const U=(H,te)=>{if(te){if(Rt(te)!==!0)return}else te=e.newValueMode;if(Oe("",e.multiple!==!0,!0),H==null)return;(te==="toggle"?ke:pt)(H,te==="add-unique"),e.multiple!==!0&&(F.value?.focus(),Ce())};if(e.onNewValue!==void 0?o("newValue",d.value,U):U(d.value),e.multiple!==!0)return}l.value===!0?$e():a.innerLoading.value!==!0&&Me()}}function kt(){return $===!0?ne.value:Q.value!==null&&Q.value.contentEl!==null?Q.value.contentEl:void 0}function Zt(){return kt()}function Jt(){return e.hideSelected===!0?[]:i["selected-item"]!==void 0?we.value.map(t=>i["selected-item"](t)).slice():i.selected!==void 0?[].concat(i.selected()):e.useChips===!0?we.value.map((t,m)=>T(ta,{key:"option-"+m,removable:a.editable.value===!0&&Ve.value(t.opt)!==!0,dense:!0,textColor:e.color,tabindex:pe.value,onRemove(){t.removeAtIndex(m)}},()=>T("span",{class:"ellipsis",[t.html===!0?"innerHTML":"textContent"]:re.value(t.opt)}))):[T("span",{class:"ellipsis",[He.value===!0?"innerHTML":"textContent"]:ee.value})]}function Ct(){if(N.value===!0)return i["no-option"]!==void 0?i["no-option"]({inputValue:d.value}):void 0;const t=i.option!==void 0?i.option:g=>T(Vl,{key:g.index,...g.itemProps},()=>T(_l,()=>T(xl,()=>T("span",{[g.html===!0?"innerHTML":"textContent"]:g.label}))));let m=me("div",Ue.value.map(t));return i["before-options"]!==void 0&&(m=i["before-options"]().concat(m)),jt(i["after-options"],m)}function el(t,m){const g=m===!0?{...Ne.value,...a.splitAttrs.attributes.value}:void 0,E={ref:m===!0?F:void 0,key:"i_t",class:S.value,style:e.inputStyle,value:d.value!==void 0?d.value:"",type:"search",...g,id:m===!0?a.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":t===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Gt.value};return t!==!0&&$===!0&&(Array.isArray(E.class)===!0?E.class=[...E.class,"no-pointer-events"]:E.class+=" no-pointer-events"),T("input",E)}function _t(t){y!==null&&(clearTimeout(y),y=null),h!==null&&(clearTimeout(h),h=null),!(t&&t.target&&t.target.qComposing===!0)&&(We(t.target.value||""),D=!0,X=d.value,a.focused.value!==!0&&($!==!0||w.value===!0)&&a.focus(),e.onFilter!==void 0&&(y=setTimeout(()=>{y=null,Ie(d.value)},e.inputDebounce)))}function We(t,m){d.value!==t&&(d.value=t,m===!0||e.inputDebounce===0||e.inputDebounce==="0"?o("inputValue",t):h=setTimeout(()=>{h=null,o("inputValue",t)},e.inputDebounce))}function Oe(t,m,g){D=g!==!0,e.useInput===!0&&(We(t,!0),(m===!0||g!==!0)&&(X=t),m!==!0&&Ie(t))}function Ie(t,m,g){if(e.onFilter===void 0||m!==!0&&a.focused.value!==!0)return;a.innerLoading.value===!0?o("filterAbort"):(a.innerLoading.value=!0,n.value=!0),t!==""&&e.multiple!==!0&&f.value.length!==0&&D!==!0&&t===re.value(f.value[0])&&(t="");const E=setTimeout(()=>{l.value===!0&&(l.value=!1)},10);B!==null&&clearTimeout(B),B=E,o("filter",t,(U,H)=>{(m===!0||a.focused.value===!0)&&B===E&&(clearTimeout(B),typeof U=="function"&&U(),n.value=!1,fe(()=>{a.innerLoading.value=!1,a.editable.value===!0&&(m===!0?l.value===!0&&Ce():l.value===!0?nt(!0):l.value=!0),typeof H=="function"&&fe(()=>{H(s)}),typeof g=="function"&&fe(()=>{g(s)})}))},()=>{a.focused.value===!0&&B===E&&(clearTimeout(B),a.innerLoading.value=!1,n.value=!1),l.value===!0&&(l.value=!1)})}function tl(){return T(Cl,{ref:Q,class:q.value,style:e.popupContentStyle,modelValue:l.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&N.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:j.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:lt.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...be.value,onScrollPassive:ge,onBeforeShow:Vt,onBeforeHide:ll,onShow:al},Ct)}function ll(t){qt(t),$e()}function al(){ye()}function ol(t){Te(t),F.value?.focus(),w.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function nl(t){Te(t),fe(()=>{w.value=!1})}function il(){const t=[T(ha,{class:`col-auto ${a.fieldClass.value}`,...P.value,for:a.targetUid.value,dark:j.value,square:!0,loading:n.value,itemAligned:!1,filled:!0,stackLabel:d.value.length!==0,...a.splitAttrs.listeners.value,onFocus:ol,onBlur:nl},{...i,rawControl:()=>a.getControl(!0),before:void 0,after:void 0})];return l.value===!0&&t.push(T("div",{ref:ne,class:q.value+" scroll",style:e.popupContentStyle,...be.value,onClick:ut,onScrollPassive:ge},Ct())),T(tt,{ref:L,modelValue:r.value,position:e.useInput===!0?"top":void 0,transitionShow:Y,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:Vt,onBeforeHide:ul,onHide:rl,onShow:sl},()=>T("div",{class:"q-select__dialog"+(j.value===!0?" q-select__dialog--dark q-dark":"")+(w.value===!0?" q-select__dialog--focused":"")},t))}function ul(t){qt(t),L.value!==null&&L.value.__updateRefocusTarget(a.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),a.focused.value=!1}function rl(t){Ce(),a.focused.value===!1&&o("blur",t),Ae()}function sl(){const t=document.activeElement;(t===null||t.id!==a.targetUid.value)&&F.value!==null&&F.value!==t&&F.value.focus(),ye()}function $e(){r.value!==!0&&(c.value=-1,l.value===!0&&(l.value=!1),a.focused.value===!1&&(B!==null&&(clearTimeout(B),B=null),a.innerLoading.value===!0&&(o("filterAbort"),a.innerLoading.value=!1,n.value=!1)))}function Me(t){a.editable.value===!0&&($===!0?(a.onControlFocusin(t),r.value=!0,fe(()=>{a.focus()})):a.focus(),e.onFilter!==void 0?Ie(d.value):(N.value!==!0||i["no-option"]!==void 0)&&(l.value=!0))}function Ce(){r.value=!1,$e()}function Ae(){e.useInput===!0&&Oe(e.multiple!==!0&&e.fillInput===!0&&f.value.length!==0&&re.value(f.value[0])||"",!0,!0)}function nt(t){let m=-1;if(t===!0){if(f.value.length!==0){const g=ve.value(f.value[0]);m=e.options.findIndex(E=>De(ve.value(E),g))}se(m)}qe(m)}function cl(t,m){l.value===!0&&a.innerLoading.value===!1&&(se(-1,!0),fe(()=>{l.value===!0&&a.innerLoading.value===!1&&(t>m?se():nt(!0))}))}function xt(){r.value===!1&&Q.value!==null&&Q.value.updatePosition()}function Vt(t){t!==void 0&&Te(t),o("popupShow",t),a.hasPopupOpen=!0,a.onControlFocusin(t)}function qt(t){t!==void 0&&Te(t),o("popupHide",t),a.hasPopupOpen=!1,a.onControlFocusout(t)}function It(){$=v.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?i["no-option"]!==void 0||e.onFilter!==void 0||N.value===!1:!0),Y=v.platform.is.ios===!0&&$===!0&&e.useInput===!0?"fade":e.transitionShow}return Bl(It),Fl(xt),It(),dt(()=>{y!==null&&clearTimeout(y),h!==null&&clearTimeout(h)}),Object.assign(s,{showPopup:Me,hidePopup:Ce,removeAtIndex:at,add:pt,toggleOption:ke,getOptionIndex:()=>c.value,setOptionIndex:qe,moveOptionSelection:Ke,filter:Ie,updateMenuPosition:xt,updateInputValue:Oe,isOptionSelected:ot,getEmittingOptionValue:gt,isOptionDisabled:(...t)=>Ve.value.apply(null,t)===!0,getOptionValue:(...t)=>ve.value.apply(null,t),getOptionLabel:(...t)=>re.value.apply(null,t)}),Object.assign(a,{innerValue:f,fieldClass:p(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:I,targetRef:F,hasValue:W,showPopup:Me,floatingLabel:p(()=>e.hideSelected!==!0&&W.value===!0||typeof d.value=="number"||d.value.length!==0||zt(e.displayValue)),getControlChild:()=>{if(a.editable.value!==!1&&(r.value===!0||N.value!==!0||i["no-option"]!==void 0))return $===!0?il():tl();a.hasPopupOpen===!0&&(a.hasPopupOpen=!1)},controlEvents:{onFocusin(t){a.onControlFocusin(t)},onFocusout(t){a.onControlFocusout(t,()=>{Ae(),$e()})},onClick(t){if(ut(t),$!==!0&&l.value===!0){$e(),F.value?.focus();return}Me(t)}},getControl:t=>{const m=Jt(),g=t===!0||r.value!==!0||$!==!0;if(e.useInput===!0)m.push(el(t,g));else if(a.editable.value===!0){const U=g===!0?Ne.value:void 0;m.push(T("input",{ref:g===!0?F:void 0,key:"d_t",class:"q-select__focus-target",id:g===!0?a.targetUid.value:void 0,value:ee.value,readonly:!0,"data-autofocus":t===!0||e.autofocus===!0||void 0,...U,onKeydown:wt,onKeyup:yt,onKeypress:bt})),g===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&m.push(T("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:St}))}if(le.value!==void 0&&e.disable!==!0&&Qe.value.length!==0){const U=Qe.value.map(H=>T("option",{value:H,selected:!0}));m.push(T("select",{class:"hidden",name:le.value,multiple:e.multiple},U))}const E=e.useInput===!0||g!==!0?void 0:a.splitAttrs.attributes.value;return T("div",{class:"q-field__native row items-center",...E,...a.splitAttrs.listeners.value},m)},getInnerAppend:()=>e.loading!==!0&&n.value!==!0&&e.hideDropdownIcon!==!0?[T(he,{class:"q-select__dropdown-icon"+(l.value===!0?" rotate-180":""),name:Fe.value})]:null}),Nt(a)}}),xa={xs:2,sm:4,md:6,lg:10,xl:14};function Ot(e,i,o){return{transform:i===!0?`translateX(${o.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}const Va=Be({name:"QLinearProgress",props:{...la,...Ol,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:i}){const{proxy:o}=et(),s=aa(e,o.$q),v=Dl(e,xa),l=p(()=>e.indeterminate===!0||e.query===!0),r=p(()=>e.reverse!==e.query),c=p(()=>({...v.value!==null?v.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),d=p(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),w=p(()=>Ot(e.buffer!==void 0?e.buffer:1,r.value,o.$q)),n=p(()=>`with${e.instantFeedback===!0?"out":""}-transition`),y=p(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${n.value} q-linear-progress__track--${s.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),h=p(()=>Ot(l.value===!0?1:e.value,r.value,o.$q)),x=p(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${n.value} q-linear-progress__model--${l.value===!0?"in":""}determinate`),$=p(()=>({width:`${e.value*100}%`})),D=p(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${n.value}`);return()=>{const B=[T("div",{class:y.value,style:w.value}),T("div",{class:x.value,style:h.value})];return e.stripe===!0&&l.value===!1&&B.push(T("div",{class:D.value,style:$.value})),T("div",{class:d.value,style:c.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},jt(i.default,B))}}}),Wt=Be({name:"QCardActions",props:{...Ll,vertical:Boolean},setup(e,{slots:i}){const o=jl(e),s=p(()=>`q-card__actions ${o.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>T("div",{class:s.value},Dt(i.default))}}),qa={class:"q-mt-md"},Ia={key:0,class:"q-mt-md"},$a={__name:"MicrophoneSetup",props:{modelValue:{type:Boolean,default:!1},isRequired:{type:Boolean,default:!1}},emits:["update:modelValue","microphone-selected"],setup(e,{emit:i}){const o=e,s=i,v=_(o.modelValue),l=_([]),r=_(null),c=_(0),d=_("");let w=null,n=null,y=null,h=null,x=null;oe(()=>o.modelValue,I=>{v.value=I,I?$():b()});async function $(){try{d.value="",(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(L=>L.stop());const F=await navigator.mediaDevices.enumerateDevices();l.value=F.filter(L=>L.kind==="audioinput").map(L=>({label:L.label||`Mikrofon ${L.deviceId.slice(0,8)}`,deviceId:L.deviceId}));const Q=localStorage.getItem("selected-microphone");Q&&(r.value=l.value.find(L=>L.deviceId===Q)),!r.value&&l.value.length>0&&(r.value=l.value[0]),r.value&&B(r.value.deviceId)}catch(I){console.error("âŒ GreÅ¡ka:",I),I.name==="NotAllowedError"?d.value="Pristup mikrofonu je odbijen. Dozvoli u pregledaÄu.":I.name==="NotFoundError"?d.value="Nije pronaÄ‘en mikrofon.":d.value="GreÅ¡ka pri pristupu mikrofonu."}}function D(I){I&&B(I.deviceId)}async function B(I){try{let ne=function(){n.getByteFrequencyData(L);const le=L.reduce((k,V)=>k+V)/Q;c.value=Math.round(le),h=requestAnimationFrame(ne)};if(X(),x=await navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:I},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),x.getAudioTracks()[0].muted){d.value="Mikrofon je mutiran u sistemu.";return}w=new(window.AudioContext||window.webkitAudioContext),n=w.createAnalyser(),y=w.createMediaStreamSource(x),y.connect(n),n.fftSize=256;const Q=n.frequencyBinCount,L=new Uint8Array(Q);ne(),d.value=""}catch(F){console.error("âŒ GreÅ¡ka pri testu:",F),d.value="Ne mogu pristupiti mikrofonu."}}function X(){h&&(cancelAnimationFrame(h),h=null),x&&(x.getTracks().forEach(I=>I.stop()),x=null),w&&(w.close(),w=null),c.value=0}async function Y(){if(r.value)try{await window.storage.set("selected-microphone",r.value.deviceId),s("microphone-selected",r.value.deviceId),s("update:modelValue",!1),b()}catch(I){console.error("âŒ GreÅ¡ka pri Äuvanju:",I)}}function A(){s("update:modelValue",!1),b()}function b(){X()}return vt(()=>{b()}),(I,F)=>(O(),_e(tt,{modelValue:v.value,"onUpdate:modelValue":F[1]||(F[1]=Q=>v.value=Q),persistent:""},{default:Z(()=>[M(mt,{style:{"min-width":"400px"}},{default:Z(()=>[M(Ze,{class:"row items-center q-pb-none"},{default:Z(()=>[F[2]||(F[2]=C("div",{class:"text-h6"},"Podesi mikrofon",-1)),M(pa),e.isRequired?ue("",!0):(O(),_e(J,{key:0,icon:"close",flat:"",round:"",dense:"",onClick:A}))]),_:1}),M(Ze,null,{default:Z(()=>[M(_a,{modelValue:r.value,"onUpdate:modelValue":[F[0]||(F[0]=Q=>r.value=Q),D],options:l.value,"option-label":"label","option-value":"deviceId",label:"Izaberi mikrofon",outlined:""},{prepend:Z(()=>[M(he,{name:"mic"})]),_:1},8,["modelValue","options"]),C("div",qa,[F[3]||(F[3]=C("div",{class:"text-caption q-mb-xs"},"Nivo zvuka:",-1)),M(Va,{value:c.value/100,color:"primary",size:"20px",class:"q-mb-xs"},null,8,["value"]),C("div",{class:xe(["text-caption",c.value>10?"text-positive":"text-grey"])},ae(c.value>10?"âœ… Mikrofon radi!":"âš ï¸ PriÄaj da testiraÅ¡ mikrofon"),3)]),d.value?(O(),K("div",Ia,[M(ea,{class:"bg-negative text-white",rounded:""},{default:Z(()=>[Hl(ae(d.value),1)]),_:1})])):ue("",!0)]),_:1}),M(Wt,{align:"right"},{default:Z(()=>[e.isRequired?ue("",!0):(O(),_e(J,{key:0,flat:"",label:"OtkaÅ¾i",onClick:A})),M(J,{label:"SaÄuvaj",color:"primary",onClick:Y,disable:!r.value||c.value===0},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Ma={class:"voice-message-container"},Aa={key:1,class:"recording-controls"},za={class:"recording-indicator"},Ta={class:"recording-timer"},Pa={key:2,class:"voice-preview-controls"},Ea={class:"preview-info"},Ba={class:"preview-text"},Fa={class:"action-buttons"},Ra=["src"],Oa={__name:"VoiceMessage",props:{conversationId:{type:[String,Number],required:!0}},setup(e){const i=Qt(),o=e,s=_(!1),v=_(!1),l=_(!1),r=_(!1),c=_(null),d=_(null),w=_([]),n=_(null),y=_(null),h=_(0),x=_(null),$=_(null),D=_(null),B=p(()=>{const u=Math.floor(h.value/60),R=h.value%60;return`${u.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`});async function X(){try{const u=localStorage.getItem("selected-microphone");u?(D.value=u,A()):r.value=!0}catch(u){console.error("âŒ GreÅ¡ka:",u),r.value=!0}}function Y(u){D.value=u,A()}async function A(){try{console.log("ðŸŽ¤ PoÄinjem snimanje..."),w.value=[],n.value=null,y.value=null,h.value=0;const u={audio:D.value?{deviceId:{exact:D.value},channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}:{channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1};d.value=await navigator.mediaDevices.getUserMedia(u);let R;MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?R={mimeType:"audio/webm;codecs=opus"}:MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?R={mimeType:"audio/ogg;codecs=opus"}:R={mimeType:"audio/webm"},c.value=new MediaRecorder(d.value,R),c.value.ondataavailable=ie=>{ie.data.size>0&&w.value.push(ie.data)},c.value.onstop=I,c.value.start(1e3),s.value=!0,F()}catch(u){console.error("âŒ GreÅ¡ka pri snimanju:",u),k(u)}}function b(){!s.value||!c.value||(console.log("ðŸ›‘ Zaustavljam snimanje..."),c.value.state!=="inactive"&&c.value.stop(),d.value&&d.value.getTracks().forEach(u=>u.stop()),s.value=!1,Q())}function I(){console.log("ðŸ”§ Obrada snimka..."),c.value.mimeType,n.value=new Blob(w.value,{type:"audio/webm"}),y.value=URL.createObjectURL(n.value),v.value=!0,console.log(`âœ… Snimljeno: ${n.value.size} bytes, ${h.value}s`)}function F(){x.value=setInterval(()=>{h.value++},1e3)}function Q(){x.value&&(clearInterval(x.value),x.value=null)}function L(){console.log("ðŸ—‘ï¸ Odbacujem snimak..."),V(),y.value&&URL.revokeObjectURL(y.value)}async function ne(){if(!n.value){console.error("âŒ Nema audio za slanje");return}i.sendVoiceMessage(o.conversationId,n.value),V()}function le(){!y.value||!$.value||(l.value?($.value.pause(),$.value.currentTime=0,l.value=!1):($.value.play(),l.value=!0))}function k(u){let R="GreÅ¡ka pri snimanju";switch(u.name){case"NotAllowedError":case"PermissionDeniedError":R="Pristup mikrofonu je odbijen";break;case"NotFoundError":case"DevicesNotFoundError":R="Nije pronaÄ‘en mikrofon";break;case"NotSupportedError":R="PregledaÄ ne podrÅ¾ava snimanje";break;default:R="Mikrofon je zauzet"}console.error("âŒ",R),V()}function V(){s.value=!1,v.value=!1,l.value=!1,h.value=0,w.value=[],n.value=null,y.value&&(URL.revokeObjectURL(y.value),y.value=null),Q()}return vt(()=>{V(),d.value&&d.value.getTracks().forEach(u=>u.stop())}),(u,R)=>(O(),K("div",Ma,[!s.value&&!v.value?(O(),_e(J,{key:0,round:"",dense:"",flat:"",icon:"mic",color:"primary",onClick:X,class:"voice-btn"})):ue("",!0),s.value?(O(),K("div",Aa,[C("div",za,[R[2]||(R[2]=C("div",{class:"pulse-animation"},null,-1)),R[3]||(R[3]=C("span",{class:"recording-text"},"Recording...",-1)),C("span",Ta,ae(B.value),1)]),M(J,{round:"",dense:"",flat:"",icon:"stop",color:"negative",onClick:b,class:"stop-btn"})])):ue("",!0),v.value&&n.value?(O(),K("div",Pa,[C("div",Ea,[C("span",Ba,"Snimak: "+ae(B.value),1),M(J,{round:"",dense:"",flat:"",icon:"play_arrow",color:"primary",onClick:le,size:"sm",disabled:l.value},null,8,["disabled"])]),C("div",Fa,[M(J,{round:"",dense:"",flat:"",icon:"close",color:"negative",onClick:L,class:"control-btn",title:"Odbaci"}),M(J,{round:"",dense:"",flat:"",icon:"send",color:"primary",onClick:ne,class:"control-btn",title:"PoÅ¡alji"})])])):ue("",!0),y.value?(O(),K("audio",{key:3,ref_key:"audioPlayer",ref:$,src:y.value,onEnded:R[0]||(R[0]=ie=>l.value=!1),hidden:""},null,40,Ra)):ue("",!0),M($a,{modelValue:r.value,"onUpdate:modelValue":R[1]||(R[1]=ie=>r.value=ie),onMicrophoneSelected:Y},null,8,["modelValue"])]))}},Da=je(Oa,[["__scopeId","data-v-101af2d1"]]),La={class:"q-mt-md"},ja={class:"row items-center justify-between"},Ha={class:"password-strength-bar q-mt-xs"},Na={class:"text-caption text-grey q-mt-sm"},Ua={class:"row items-center q-mt-xs"},Qa={class:"row items-center q-mt-xs"},Ka={class:"row items-center q-mt-xs"},Wa={class:"row items-center q-mt-xs"},Ga={__name:"CryptMessageDialog",props:{modelValue:Boolean,cryptPassword:String},emits:["update:modelValue","cancel","password-set"],setup(e,{emit:i}){const o=e,s=i,v=_(o.cryptPassword||""),l=_(""),r=_(!1),c=_(0);oe(()=>o.modelValue,A=>{A&&(v.value=o.cryptPassword||"",l.value="",r.value=!1,c.value=0,B())}),oe(()=>o.cryptPassword,A=>{console.log("Dialog: cryptPassword prop changed to:",A),v.value=A||""});const d=p(()=>/[A-Z]/.test(v.value)),w=p(()=>/[a-z]/.test(v.value)),n=p(()=>/\d/.test(v.value)),y=p(()=>/[!@#$%^&*()_+\-=[\]{};':"|,.<>?]/.test(v.value)),h=p(()=>{if(!v.value)return"Empty";const A=c.value;return["Very Weak","Weak","Medium","Strong","Very Strong"][A]||"Weak"}),x=p(()=>["text-negative","text-orange","text-warning","text-positive","text-positive"][c.value]||"text-grey"),$=p(()=>v.value.length>=4);function D(A){if(!v.value)return"empty";const b=c.value;return A<=b?["weak","weak","medium","strong","strong"][b]:"empty"}function B(){if(!v.value){c.value=0;return}let A=0;const b=Math.min(v.value.length/2,10);A+=b*.4;let I=0;d.value&&(I+=2.5),w.value&&(I+=2.5),n.value&&(I+=2.5),y.value&&(I+=2.5),d.value&&w.value&&n.value&&y.value&&(I+=5),A+=I*.6,A<4?c.value=0:A<6?c.value=1:A<8?c.value=2:A<10?c.value=3:c.value=4}function X(){console.log("setPassword called, canEnable:",$.value),$.value?(console.log("Emitting password-set with:",v.value),s("password-set",v.value),console.log("Closing dialog..."),s("update:modelValue",!1)):console.log("Cannot enable - requirements not met")}function Y(){s("cancel"),s("update:modelValue",!1)}return oe(v,B),(A,b)=>(O(),_e(tt,{"model-value":e.modelValue,"onUpdate:modelValue":b[3]||(b[3]=I=>A.$emit("update:modelValue",I))},{default:Z(()=>[M(mt,{style:{"min-width":"400px"}},{default:Z(()=>[M(Ze,null,{default:Z(()=>[...b[4]||(b[4]=[C("div",{class:"text-h6"},"Set Encryption Password",-1),C("div",{class:"text-caption q-mt-sm"}," This password will be used to encrypt all sent and received messages in this conversation. Please select a strong password for maximum protection. ",-1)])]),_:1}),M(Ze,{class:"q-pt-none"},{default:Z(()=>[M(ct,{modelValue:v.value,"onUpdate:modelValue":[b[1]||(b[1]=I=>v.value=I),B],type:r.value?"text":"password",label:"Password",outlined:"",dense:"",class:"q-mb-sm",autocomplete:"new-password",autocapitalize:"off",autocorrect:"off",spellcheck:"false"},{append:Z(()=>[M(he,{name:r.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:b[0]||(b[0]=I=>r.value=!r.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),M(ct,{modelValue:l.value,"onUpdate:modelValue":b[2]||(b[2]=I=>l.value=I),type:r.value?"text":"password",label:"Confirm Password",outlined:"",dense:"",rules:[I=>I===v.value||"Passwords do not match"],autocomplete:"new-password",autocapitalize:"off",autocorrect:"off",spellcheck:"false"},null,8,["modelValue","type","rules"]),C("div",La,[C("div",ja,[b[5]||(b[5]=C("div",{class:"text-caption"},"Password Strength:",-1)),C("div",{class:xe(["text-caption",x.value])},ae(h.value),3)]),C("div",Ha,[(O(),K(Xe,null,Ye(4,I=>C("div",{key:I,class:xe(["strength-segment",D(I-1)])},null,2)),64))]),C("div",Na,[b[10]||(b[10]=C("div",null,"Password should contain:",-1)),C("div",Ua,[M(he,{name:v.value.length>=8?"check_circle":"radio_button_unchecked",size:"12px",color:v.value.length>=8?"positive":"grey",class:"q-mr-xs"},null,8,["name","color"]),b[6]||(b[6]=C("span",null,"At least 8 characters",-1))]),C("div",Qa,[M(he,{name:d.value&&w.value?"check_circle":"radio_button_unchecked",size:"12px",color:d.value&&w.value?"positive":"grey",class:"q-mr-xs"},null,8,["name","color"]),b[7]||(b[7]=C("span",null,"Uppercase & lowercase letters",-1))]),C("div",Ka,[M(he,{name:n.value?"check_circle":"radio_button_unchecked",size:"12px",color:n.value?"positive":"grey",class:"q-mr-xs"},null,8,["name","color"]),b[8]||(b[8]=C("span",null,"At least one number",-1))]),C("div",Wa,[M(he,{name:y.value?"check_circle":"radio_button_unchecked",size:"12px",color:y.value?"positive":"grey",class:"q-mr-xs"},null,8,["name","color"]),b[9]||(b[9]=C("span",null,"At least one special character",-1))])])])]),_:1}),M(Wt,{align:"right",class:"q-px-md q-pb-md"},{default:Z(()=>[M(J,{flat:"",label:"Cancel",color:"grey",onClick:Y}),M(J,{label:"Set Password",color:"primary",onClick:X,disable:!$.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}},Xa=je(Ga,[["__scopeId","data-v-8288ee10"]]),Ya={id:"conversation-container"},Za={id:"conversation-header",class:"row items-center"},Ja={class:"col-9 row items-center"},eo={key:0},to={class:"message-sender q-ml-sm ellipsis",style:{"font-size":"24px"}},lo={class:"col-3 text-right"},ao={key:0},oo=["src"],no={class:"message-sender"},io={key:1},uo={key:2},ro={key:0},so={key:1,class:"media-container"},co=["onClick"],vo=["src"],fo={class:"play-button-overlay"},mo={key:0,class:"video-duration"},go={key:2,class:"media-container"},po=["onClick"],ho=["src"],yo={class:"image-corner-icon"},So={class:"time"},bo={id:"conversation-input",style:{position:"relative"},class:"row items-center q-gutter-sm"},wo={key:0,class:"mini-emoji-picker"},ko={class:"emoji-tabs"},Co=["onClick"],_o={class:"emoji-grid"},xo=["onClick"],Vo={__name:"ConversationPage",setup(e){const i=_(null),o=Nl(),s=Zl(),v=p(()=>s.user),l=Qt(),r=p(()=>o.params.conversationId),c=p(()=>l.getConversationById(r.value)),d=p(()=>l.messages.ids.map(k=>l.messages.entities[k]).filter(k=>k.conversationId==r.value)),w=_(""),n=_(!1),y=_(0),h=_(!1),x=p(()=>!!l.conversations.entities[r.value]?.encrypted),$=_(!1),D=p(()=>l.conversations.entities[r.value]?.cryptPassword||"");async function B(k){k&&($.value=!0);try{await l.changeEncrypted(r.value,k)}catch(V){console.error("Failed to disable encryption:",V)}}function X(k){l.setConversationPassword(r.value,k)}const Y=p(()=>d.value.filter(k=>k.type==="attachment"&&(k.attachmentType==="video"||k.attachmentType==="image")).map(k=>({url:`${k.attachmentPath}?conversationId=${r.value}&token=${s.token}`,type:k.attachmentType,messageId:k.id,thumbnail:k.thumbnail}))),A=_(0);function b(k){const V=Y.value.findIndex(u=>u.messageId===k.id);V!==-1&&(A.value=V,h.value=!0)}function I(){fe(()=>{const k=i.value;k&&(k.scrollTop=k.scrollHeight)})}function F(k){w.value+=k,n.value=!1}const Q=k=>{if(!k||isNaN(k))return"0:00";const V=Math.floor(k/60),u=Math.floor(k%60);return`${V}:${u<10?"0":""}${u}`};async function L(){const k=i.value;if(k&&k.scrollTop===0){const V=k.scrollHeight;await l.openConversation(r.value),await fe(),k.scrollTop=k.scrollHeight-V}}function ne(){w.value.trim()&&(l.sendMessage(r.value,w.value,x.value,D.value),w.value="")}function le(k){l.handleFileUpload(r.value,k)}return Lt(()=>{I()}),oe(()=>d.value.length,()=>{I()}),oe([()=>r.value,()=>l.conversationsLoaded],([k,V])=>{!k||!V||(l.activeConversationId=r.value,l.openConversation(k),l.markAsRead(r.value))},{immediate:!0}),(k,V)=>(O(),_e(Yl,{class:xe(["column",k.$q.dark.isActive?"bg-dark text-white":"bg-grey-2 text-dark"])},{default:Z(()=>[C("div",Ya,[C("div",Za,[C("div",Ja,[c.value?.type=="private"?(O(),K("span",eo)):ue("",!0),C("span",to,ae(c.value?.participantsNames.display),1)]),C("div",lo,[C("div",null,"Kriptovanje : "+ae(x.value)+" | PASS: "+ae(D.value),1),M(ql,{size:"xl",modelValue:x.value,"onUpdate:modelValue":[V[0]||(V[0]=u=>x.value=u),B],color:"red",val:"xl",label:"Crypt conversation",dense:""},null,8,["modelValue"])])]),M(Xa,{modelValue:$.value,"onUpdate:modelValue":V[1]||(V[1]=u=>$.value=u),cryptPassword:D.value,onCancel:V[2]||(V[2]=u=>$.value=!1),onPasswordSet:X},null,8,["modelValue","cryptPassword"]),C("div",{id:"conversation-messages",ref_key:"messagesContainer",ref:i,onScroll:L},[(O(!0),K(Xe,null,Ye(d.value,u=>(O(),K("div",{key:u.id,class:xe(["message",[u.senderId==v.value?.id?"me":"other",u?.status=="success"?"success-encrypt":"",u?.status=="failed"?"failed-encrypt":""]])},[c.value?.type=="group"&&u.senderId!=v.value?.id?(O(),K("div",ao,[M(Ul,{size:"40px"},{default:Z(()=>[C("img",{src:u.senderAvatar,alt:""},null,8,oo)]),_:2},1024),C("span",no,ae(u.senderName),1)])):ue("",!0),u.type=="message"?(O(),K("div",io,ae(u.text),1)):u.type=="attachment"?(O(),K("div",uo,[u.attachmentType=="audio"?(O(),K("div",ro,[M(ga,{audioUrl:`${u.attachmentPath}?conversationId=${r.value}&token=${Pe(s).token}`,isMe:!0,messageId:u.id,duration:u.duration},null,8,["audioUrl","messageId","duration"])])):u.attachmentType=="video"?(O(),K("div",so,[C("div",{class:"video-thumbnail",onClick:R=>b(u)},[C("img",{src:`${u.thumbnail}?conversationId=${r.value}&token=${Pe(s).token}`,alt:"video",class:"media-thumbnail"},null,8,vo),C("div",fo,[M(he,{name:"play_circle",size:"48px",color:"white"})]),u.duration?(O(),K("div",mo,ae(Q(u.duration)),1)):ue("",!0)],8,co)])):u.attachmentType=="image"?(O(),K("div",go,[C("div",{class:"image-thumbnail",onClick:R=>b(u)},[C("img",{src:`${u.thumbnail}?conversationId=${r.value}&token=${Pe(s).token}`,alt:"image",class:"media-thumbnail"},null,8,ho),C("div",yo,[M(he,{name:"photo",size:"16px",color:"white"})])],8,po)])):ue("",!0)])):ue("",!0),C("span",So,ae(Pe(Jl).time(u.createdAt)),1)],2))),128))],544),C("div",bo,[M(J,{flat:"",round:"",icon:"camera_alt",onClick:V[3]||(V[3]=u=>k.$refs.cameraInput.click())}),M(J,{flat:"",round:"",icon:"attach_file",onClick:V[4]||(V[4]=u=>k.$refs.fileInput.click())}),M(ct,{modelValue:w.value,"onUpdate:modelValue":V[6]||(V[6]=u=>w.value=u),placeholder:"NapiÅ¡i poruku...",onKeyup:Ql(ne,["enter"]),dense:"",outlined:"",rounded:"",class:"col"},{prepend:Z(()=>[M(J,{flat:"",round:"",dense:"",icon:"sentiment_satisfied",onClick:V[5]||(V[5]=u=>n.value=!n.value)})]),append:Z(()=>[M(Da,{conversationId:r.value},null,8,["conversationId"])]),_:1},8,["modelValue"]),M(J,{label:"PoÅ¡alji",color:"primary",onClick:ne}),C("input",{ref:"fileInput",type:"file",accept:"image/*,video/*, audio/*",style:{display:"none"},onChange:le},null,544),C("input",{ref:"cameraInput",type:"file",accept:"image/*",capture:"environment",style:{display:"none"},onChange:le},null,544),n.value?(O(),K("div",wo,[C("div",ko,[(O(!0),K(Xe,null,Ye(Pe(Pt),(u,R)=>(O(),K("button",{key:u.name,onClick:ie=>y.value=R,class:xe({active:y.value===R})},ae(u.name),11,Co))),128))]),C("div",_o,[(O(!0),K(Xe,null,Ye(Pe(Pt)[y.value].emojis,u=>(O(),K("span",{key:u,class:"emoji",onClick:R=>F(u)},ae(u),9,xo))),128))])])):ue("",!0)])]),M(sa,{modelValue:h.value,"onUpdate:modelValue":V[7]||(V[7]=u=>h.value=u),mediaIndex:A.value,media:Y.value},null,8,["modelValue","mediaIndex","media"])]),_:1},8,["class"]))}},Fo=je(Vo,[["__scopeId","data-v-7ea93440"]]);export{Fo as default};
